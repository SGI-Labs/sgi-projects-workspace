# Story 1.3: Prototype Remote Edit & Build Loop

## Status
Archived

> **Note:** This story captured an earlier macOS-to-IRIX prototype. The direction has shifted to an IRIX-native implementation tracked under Story 1.5. Historic details below are retained for reference.

## Story
**As a** developer exploring the IRIX IDE foundations
**I want** a working prototype that syncs local edits from macOS to IRIX and performs remote builds with live feedback
**so that** we validate the core workflow before investing in full UI implementation

## Historical Content (macOS Prototype)

### Acceptance Criteria
1. Provide a macOS-side prototype (CLI or lightweight tool) that watches a local project directory and syncs changed files to an IRIX host using the documented SSH transport.
2. Implement a remote build command that invokes MIPSPro (or equivalent) on the IRIX host and streams build output back to macOS in real time.
3. Demonstrate the prototype using a sample project (e.g., hello world C program) and document setup/usage steps in a short README under the prototype directory.
4. Capture key findings, limitations, and follow-up questions in `projects/irix-ide/docs/architecture/future-work.md` and/or the PRD workflow section.

## Tasks / Subtasks
- [x] Review tech stack expectations for remote workflows, transport, and build orchestration; summarize relevant constraints in Dev Notes (AC: 1-2)
- [x] Create `projects/irix-ide/tools/prototype/edit-build-loop/` with:
  - [x] macOS helper script/service that detects file changes and triggers sync via `scp`/`rsync` (AC: 1)
  - [x] configuration sample (host, paths) aligned with YAML manifest approach from tech stack (AC: 1)
- [x] Implement build launcher script/command that runs remote `cc` (or equivalent) and streams logs (AC: 2)
- [x] Add documentation (`README.md`) describing setup, required environment (SSH profile, sample project), usage, and limitations (AC: 3)
- [x] Update `projects/irix-ide/docs/architecture/future-work.md` (and PRD workflow goals if needed) with observed challenges / next steps (AC: 4)
- [x] Provide validation evidence (command transcripts or log excerpts) in Dev Notes / Debug Log references (AC: 2-3)

## Dev Notes
- Tech stack mandates SSH-based transport, incremental sync, and remote build orchestration `[Source: projects/irix-ide/docs/architecture/tech-stack.md#remote-workflow]`.
- Coding standards require Rust/Python for services; lightweight prototype may use Python for quick iteration `[Source: projects/irix-ide/docs/architecture/coding-standards.md#shared-services-rustpython]`.
- Source tree suggests placing prototypes under `tools/` and documenting them appropriately `[Source: projects/irix-ide/docs/architecture/source-tree.md]`.
- Success metrics for workflows include build feedback latency; capture measured times for insight `[Source: projects/irix-ide/docs/prd.md#core-workflows]`.
- Ensure any IRIX-side interactions respect Motif/Indigo Magic styling if UI is involved; prototype is CLI but note implications `[Source: projects/irix-ide/docs/prd.md#workflow-goals]`.

## Testing
- Manual validation: run prototype end-to-end, confirm remote build success, and document observed timings/log outputs.

## Change Log
| Date       | Version | Description                                | Author |
|------------|---------|--------------------------------------------|--------|
| 2024-02-14 | 0.1     | Initial draft prepared by Scrum Master Bob | Bob    |

## Dev Agent Record
### Agent Model Used
James (local tools)

### Debug Log References
- Successful prototype run commands: `python sync_loop.py --config config.sample.yml --watch --timeout 5`, `python remote_build.py --config config.sample.yml --command "cd ~/src/irix_ide_prototype && mkdir -p bin && cc -o bin/hello src/hello.c"`, and remote execution `ssh mario@octane ./src/irix_ide_prototype/bin/hello`.
- Dependency and path validation: `.venv/bin/python sync_loop.py --config config.sample.yml --dry-run`, `.venv/bin/python remote_build.py --config config.sample.yml --dry-run`.

### Completion Notes List
- Added prototype sync/build scripts, sample config, and README documentation; verified live rsync sync and remote build execution (binary produced and executed on IRIX).
- Documented required PyYAML dependency, added `requirements.txt`, and resolved config-relative path handling to satisfy QA feedback.

### File List
- projects/irix-ide/tools/prototype/edit-build-loop/config_loader.py
- projects/irix-ide/tools/prototype/edit-build-loop/sync_loop.py
- projects/irix-ide/tools/prototype/edit-build-loop/remote_build.py
- projects/irix-ide/tools/prototype/edit-build-loop/config.sample.yml
- projects/irix-ide/tools/prototype/edit-build-loop/README.md
- projects/irix-ide/tools/prototype/edit-build-loop/sample-project/src/hello.c
- projects/irix-ide/tools/prototype/edit-build-loop/requirements.txt
- projects/irix-ide/docs/architecture/future-work.md


## QA Results
### Review Date: 2025-09-20

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment
Prototype assets align with architecture guidance:
- AC1 → `sync_loop.py` with YAML-driven rsync configuration.
- AC2 → `remote_build.py` streaming remote compiler output.
- AC3 → `README.md` and `sample-project/` demonstrating the workflow.
- AC4 → Follow-ups captured in `architecture/future-work.md`.
Execution gap: scripts error immediately when `PyYAML` is not installed, yet README lists it as optional.

### Refactoring Performed
None.

### Compliance Check
- Coding Standards: ✓ (Python modules follow shared conventions)
- Project Structure: ✓ (Prototype lives under `tools/prototype/edit-build-loop/`)
- Testing Strategy: ✗ (Manual run blocked by missing dependency)
- All ACs Met: ✗ (Prototype cannot execute without clarifying/installing PyYAML)

### Improvements Checklist
- [ ] Document `PyYAML` as a required dependency (or vendor requirements file) so the prototype runs out-of-the-box.
- [ ] Consider resolving relative paths against the config file location to support running scripts from repo root.
- [ ] Add smoke script or CI stub to validate sync/build entry points with `--dry-run` to prevent regressions.
- [ ] Trim unused imports (e.g., `tempfile` in `scp_sync.py`) and ship a minimal `.gitignore` covering macOS artifacts.

### Security Review
SSH-based transport respected; ensure private key paths rely on local file permissions.

### Performance Considerations
Sample timings captured in README; future improvements note switching to filesystem notifications for lower latency.

### Files Modified During Review
None.

### Gate Status
Gate: CONCERNS → projects/irix-ide/docs/qa/gates/1.3-ide-remote-edit-build-prototype.yml
Risk profile: not generated
NFR assessment: not generated

### Recommended Status
[✗ Changes Required - See unchecked items above]

### Review Date: 2025-09-20 (Recheck)

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment
Dependency management and path handling fixes validated:
- PyYAML requirement documented (`requirements.txt`) and import guard provides actionable guidance.
- Relative paths now resolve against the config location, enabling execution from any directory.
- AC1–AC4 reconfirmed via dry-run sync/build executions using the updated tooling.

### Refactoring Performed
None during QA recheck.

### Compliance Check
- Coding Standards: ✓ (Python modules adhere to project conventions)
- Project Structure: ✓ (Prototype assets scoped under `tools/prototype/edit-build-loop/`)
- Testing Strategy: ✓ (`--dry-run` sync/build flows executed via `.venv/bin/python`)
- All ACs Met: ✓ (Prototype operates as documented once dependencies installed)

### Improvements Checklist
- [ ] Add automated smoke (CI or script) exercising the `--dry-run` paths to guard regressions.
- [ ] Remove unused imports (e.g., `tempfile` in `scp_sync.py`) and extend `.gitignore` for macOS artifacts.

### Security Review
Dependency guidance leverages local virtualenv; SSH key usage unchanged and remains scoped to user environment.

### Performance Considerations
Dry-run validation unaffected; existing metrics in README still represent baseline expectations.

### Files Modified During Review
None.

### Gate Status
Gate: PASS → projects/irix-ide/docs/qa/gates/1.3-ide-remote-edit-build-prototype.yml
Risk profile: not generated
NFR assessment: not generated

### Recommended Status
[✓ Ready for Done]
