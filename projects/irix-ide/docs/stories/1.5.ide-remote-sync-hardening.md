# Story 1.5: Remote Sync Loop Hardening

## Status
Draft

## Story
**As a** remote IDE operator
**I want** a resilient sync service that queues edits, retries failures, and reconciles conflicts
**so that** my work stays consistent across IRIX hosts even under flaky network conditions

## Acceptance Criteria
1. Queue writes when the IRIX host is unreachable and replay them automatically once connectivity is restored, with timestamped audit logs.
2. Expose retry/backoff state via structured JSON so the UI can surface progress, next attempt, and failure counts.
3. Detect file conflicts (e.g., remote file newer than local) and emit actionable events for the UI to launch the sync conflict resolver.
4. Document operational procedures and edge cases (permissions errors, disk full, SSH auth failures) in `docs/user-guides/` and add follow-ups to `architecture/future-work.md` if needed.
5. Provide integration tests exercising queue persistence, retry timing, and conflict hooks using mocked IRIX endpoints.

## Tasks / Subtasks
- [ ] Review existing prototype sync scripts and capture current retry/queue gaps in Dev Notes.
- [ ] Implement durable queue storage (sqlite/jsonl) for pending sync operations with retry metadata.
- [ ] Add conflict detection hooks comparing local checksum/mtime versus remote response and publish structured events.
- [ ] Create integration test harness under `tests/sync/` with mocked SSH responses covering offline, success, and conflict scenarios.
- [ ] Update operator documentation under `docs/user-guides/` describing retry indicators, log locations, and manual override commands.

## Dev Notes
- Transport, sync, and retry expectations are defined in `projects/irix-ide/docs/architecture/tech-stack.md#remote-workflow`.
- Schemes for user feedback should align with the Offline Work Drawer story (`docs/front-end-spec.md#animation--micro-interactions`).
- Conflict resolution UI references are in `docs/user-guides/mockups/overlays/sync-conflict.md`.

## Testing
- Automated integration suite simulating dropped SSH sessions plus manual dry-run verifying queue replay and conflict event payloads.

## Change Log
| Date       | Version | Description                 | Author |
|------------|---------|-----------------------------|--------|
| 2025-09-21 | 0.1     | Initial draft auto-generated | James  |
